# 아키텍쳐 개요

아키텍쳐를 설계할 때 출현하는 전형적인 네 가지 영역

→ 표현, 응용, 도메인, 인프라스트럭처

> 스프링 MVC 프레임워크가 표현 영역을 위한 기술에 해당!
> 

### 계층 구조 아키텍쳐

계층 구조는 그 특성상 상위 계층에서 하위 계층으로의 의존만 존재하고 하위 계층은 상위 계층에 의존하지 않는다

> 일반적으로는 응용(서비스)계층에서 직접적으로 인프라계층에 의존성을 두지 않고 도메인단을 거친다
> 

### DIP

일반적인 상황 : 고수준 모듈이 구현을 위해 저수준 모듈을 사용하면, 구현 변경과 테스트가 어렵다는 문제가 발생한다. 

why? 저수준의 규칙과 파라미터를 따라야 하고, 저수준 모듈이 완전히 작동해야 고수준 모듈의 테스트가 가능하기 때문

> **DIP는 이 문제를 해결하기 위해 저수준 모듈이 고수준 모듈에 의존하도록 바꾼다**
> 

고수준 서비스 → 인터페이스 주입

저수준 인프라 구현체 → 인터페이스 구현

헷갈리는 부분! **인터페이스는 저수준 인프라의 기능을 정의해둔것이지만 저수준이 아닌 고수준 모듈이다!**
![IMG_2246](https://github.com/user-attachments/assets/96ac222d-31a3-461a-9cb8-9692a9432101)


고수준 모듈이 저수준 모듈에 의존하는 것이 기본적 흐름이지만, 위의 상황은 저수준 모듈이 고수준 모듈에 의존하는 것이기 때문에 DIP, 의존 역전 원칙이라고 불린다

- 저수준의 구현 기술을 변경하더라도 고수준 모듈을 수정할 필요가 없다. 구현 객체를 생성하는 코드만 변경하면 된다
- 실제 구현 객체 없이도 테스트 대역을 통해 거의 모든 기능을 테스트 할 수 있다. mock 사용도 용이해진다

### 도메인 영역의 주요 구성요소

- 엔티티와 밸류
    - DB 테이블의 엔티티와 도메인 모델의 엔티티는 다르다
    - 도메인 모델의 엔티티는 데이터와 함께 도메인 기능을 제공한다
    - 도메인 모델의 에닡티는 두 개 이상의 데이터가 개념적으로 하나인 경우 밸류 타입을 이용해서 표현할 수 있다
- 애그리거트
    - 관련 객체를 하나로 묶은 군집이다
    - 애그리거트는 군집에 속한 객체를 관리하는 루트 엔티티를 갖는다
- 리포지터리
    
    > 이 책에서는 도메인단에 리포지터리의 인터페이스를 정의했다 → 응용계층 or 도메인계층에 대한 논의가 필요할 것 같다
    > 

### 모듈 구성

패키지 구성 규칙에 정답이 존재하는 것은 아니다

- 영역별로 별도 패키지로 구성 가능
- 도메인이 크면 하위 도메인 별로 모듈을 나누기 가능
- 애그리거트 구조라면 하위 도메인을 하위 패키지로 구성한 모듈 구조 가능
